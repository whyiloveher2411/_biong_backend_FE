import { Box, Button, Divider } from '@mui/material';
import { FieldFormItemProps } from 'components/atoms/fields/type';
import { __ } from 'helpers/i18n';
import useAjax from 'hook/useApi';
import useConfirmDialog from 'hook/useConfirmDialog';

function CopyFreecodecampLocal(props: FieldFormItemProps) {

    const useApi = useAjax();

    // const totalStep = React.useState(0);
    // const html = React.useState('');

    const handleCopyData = () => {
        useApi.ajax({
            url: 'plugin/vn4-e-learning/course-feecodecamp/copy',
            data: {
                id: props.post.id,
            },
            method: 'POST',
            success: (result) => {
                if (result.content) {
                    let item = result.content;
                    navigator.clipboard.writeText(JSON.stringify(item));
                    useApi.showMessage(__('Copied to clipboard.'), 'info');
                }
            }
        })
    }

    const handlePasteData = () => {

        navigator.clipboard.readText()
            .then(text => {
                let itemFromclipboard = JSON.parse(text);
                console.log(itemFromclipboard);

                useApi.ajax({
                    url: 'plugin/vn4-e-learning/course-feecodecamp/paste',
                    data: {
                        id: props.post.id,
                        data: itemFromclipboard,
                    },
                    method: 'POST',
                    success: (result) => {
                        console.log(result);
                    }
                })
            })
            .catch(() => {
                //
            });
    }

    const autoGenerateData = () => {
        useApi.ajax({
            url: 'plugin/vn4-e-learning/course-feecodecamp/auto-generate',
            data: {
                id: props.post.id,
            },
            method: 'POST',
            success: (result) => {
                //
            }
        })
    }

    // const autoGenerateDataFromHTML = () => {
    //     useApi.ajax({
    //         url: 'plugin/vn4-e-learning/course-feecodecamp/auto-generate-html',
    //         data: {
    //             id: props.post.id,
    //             html: html[0],
    //             step: totalStep[0],
    //         },
    //         method: 'POST',
    //         success: (result) => {
    //             //
    //         }
    //     })
    // }

    const confirm = useConfirmDialog({
        title: 'Thêm dữ liệu',
        message: 'Bạn có chắc muốn chỉnh sửa / thêm dữ liệu không?'
    });

    return (<>

        {/* <FieldForm
            component='number'
            config={{
                title: 'Total Step'
            }}
            post={{ step: totalStep[0] }}
            name="step"
            onReview={(value) => {
                totalStep[1](value);
            }}
        /> */}


        {/* <Divider sx={{ mt: 3, mb: 3, }} />
        <Box
            sx={{
                mb: 3,
            }}
        >
            <FieldForm
                component='textarea'
                config={{
                    title: 'HTML Course'
                }}
                post={{ html: html[0] }}
                name="html"
                onReview={(value) => {
                    html[1](value);
                }}
            />
        </Box> */}

        <Divider sx={{ mt: 3, mb: 3, }} />

        <Button sx={{ mt: 1, }} variant='outlined' onClick={autoGenerateData}>
            Lấy data từ freecodecamp
        </Button>

        {/* <Box>
            <Button variant='outlined' onClick={autoGenerateDataFromHTML}>
                Tự động lấy data từ freecodecamp
            </Button>
        </Box> */}
        <Box sx={{ mt: 1, mb: 1 }}>
            <Button variant='outlined' onClick={handleCopyData}>
                Copy data của khóa học này từ local (Chỉ nhấn ở local)
            </Button>
        </Box>
        <Box>
            <Button variant='outlined' onClick={() => {
                confirm.onConfirm(() => {
                    handlePasteData();
                });
            }}>
                Past data từ local đến server (Chỉ nhấn trên server)
            </Button>
        </Box>
        {confirm.component}
    </>)
}

export default CopyFreecodecampLocal